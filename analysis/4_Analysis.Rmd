---
title: "4_Analysis"
author: "Catherine Arnett"
date: "11/29/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)

```

# Replicating Everett's findings

## Replicate Ejective-Elevation Correlation

```{r}
final.data$glot_features_new = final.data$glot_features

final.data$glot_features_new <- ifelse(final.data$glot_features_new == '2 - Ejectives only', 1,
                         ifelse(final.data$glot_features_new == '1 - No glottalized consonants', 0,
                                0))

ejectives.elevation <- lm(data = final.data, glot_features_new ~ elev_m)
summary(ejectives.elevation)
anova(ejectives.elevation)
```


```{r}
final.data$elev_binary <- final.data$elev_m

final.data$elev_binary<- ifelse(final.data$elev_binary >= 1500, 'high',
                         ifelse(final.data$elev_binary < 1500, 'low',
                                'low'))

final.data <- final.data %>%
  mutate(elev_binary = as.character(elev_binary))

ejectives.elevation2 <- lm(data = final.data, glot_features_new ~ elev_binary)
summary(ejectives.elevation2)
```
## Replicate C-V Ratio-Latitude Correlation

```{r}
final.data$cv_ratio_num <- final.data$cv_ratio 

final.data$cv_ratio_num <- ifelse(final.data$cv_ratio_num == '1 - Low', 1,
                              ifelse(final.data$cv_ratio_num == '2 - Moderately low', 2,
                                 ifelse(final.data$cv_ratio_num == '3 - Average', 3,
                                         ifelse(final.data$cv_ratio_num == '4 - Moderately high', 4,
                                                 ifelse(final.data$cv_ratio_num == '5 - High', 5,
                                                          1)))))

final.data <- final.data %>%
  mutate(cv_ratio_num = as.numeric(cv_ratio_num))



```

## Replicate Tone-Humidity Correlation

```{r}
final.data$tone_num <- final.data$tones

final.data$tone_num  <- ifelse(final.data$tone_num  == '1 - No tones', 1,
                              ifelse(final.data$tone_num  == '2 - Moderately low', 2,
                                 ifelse(final.data$tone_num  == '3 - Average', 3,
                                                          1)))


```

# Finding alternative correlations

Some factors, which might help explain this apparent correlation between climate and language structure are: a) community size, b) GDP, and c) linguistic diversity of a country or region.


## First look to see whether GDP predicts features

### Ejectives

There is a marginal effect of GDP on whether or not a language 

```{r}
ejectives.GDP <- lm(data = final.data, glot_features_new ~ `2018`)
summary(ejectives.GDP)
```

### CV Ratio

There is a significant correlation between CV-ratio and GDP. 

```{r}
cv.GDP <- lm(data = final.data, cv_ratio_num ~ `2018`)
summary(cv.GDP)
```

### Tone

```{r}


```
