---
title: "4_Analysis"
author: "Catherine Arnett"
date: "11/29/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
load("~/GitHub/LTG-Language_Typology_Geography/clean-data/final_data.RData")

```

# Replicating Everett's findings

## Replicate Ejective-Elevation Correlation

```{r}
final.data$glot_features_new = final.data$glot_features

final.data$glot_features_new <- ifelse(final.data$glot_features_new == '2 - Ejectives only', 1,
                         ifelse(final.data$glot_features_new == '1 - No glottalized consonants', 0,
                                0))

ejectives.elevation <- lm(data = final.data, glot_features_new ~ elev_m)
summary(ejectives.elevation)
anova(ejectives.elevation)
```


```{r}
final.data$elev_binary <- final.data$elev_m

final.data$elev_binary<- ifelse(final.data$elev_binary >= 1500, 'high',
                         ifelse(final.data$elev_binary < 1500, 'low',
                                'low'))

final.data <- final.data %>%
  mutate(elev_binary = as.character(elev_binary))

ejectives.elevation2 <- lm(data = final.data, glot_features_new ~ elev_binary)
summary(ejectives.elevation2)
```
## Replicate C-V Ratio-Latitude Correlation

```{r}
final.data$cv_ratio_num <- final.data$cv_ratio 

final.data$cv_ratio_num <- ifelse(final.data$cv_ratio_num == '1 - Low', 1,
                              ifelse(final.data$cv_ratio_num == '2 - Moderately low', 2,
                                 ifelse(final.data$cv_ratio_num == '3 - Average', 3,
                                         ifelse(final.data$cv_ratio_num == '4 - Moderately high', 4,
                                                 ifelse(final.data$cv_ratio_num == '5 - High', 5,
                                                          1)))))

final.data <- final.data %>%
  mutate(cv_ratio_num = as.numeric(cv_ratio_num))



```

## Replicate Tone-Humidity Correlation

```{r}
final.data$tone_num <- final.data$tones

final.data$tone_num <- ifelse(final.data$tone_num  == '1 - No tones', 1,
                              ifelse(final.data$tone_num  == '2 - Moderately low', 2,
                                 ifelse(final.data$tone_num  == '3 - Average', 3,
                                                          1)))
final.data <- final.data %>%
  mutate(tone_num = as.numeric(tone_num))

```

# Finding alternative correlations

Some factors, which might help explain this apparent correlation between climate and language structure are: a) community size, b) GDP, and c) linguistic diversity of a country or region.


## First look to see whether GDP predicts features

### Ejectives

There is a marginal effect of GDP on whether or not a language has ejectives. 

```{r}
ejectives.GDP <- lm(data = final.data, glot_features_new ~ `2018`)
summary(ejectives.GDP)
```

### CV Ratio

There is a significant correlation between CV-ratio and GDP. 

```{r}
cv.GDP <- lm(data = final.data, cv_ratio_num ~ `2018`)
summary(cv.GDP)
```

### Tone

There is no significant correlation between GDP and tone. 

```{r}
tone.GDP <- lm(data = final.data, tone_num ~ `2018`)
summary(tone.GDP)

```

## Next look at linguistic diversity

We're testing whether languages spoken in countries with high linguistic diversity are more likely to have these features. 

```{r}
#create a new diversity score 

final.data <- final.data %>%
  mutate(diversity.new = established.langs/total.speakers)

```

### Ejectives

There is a significant correlation between high linguistic diversity and having ejectives.

```{r}
ejectives.diversity <- lm(data = final.data, glot_features_new ~ diversity.new)
summary(ejectives.diversity)
```
### CV Ratio

There is a significant correlation between high CV ratio and high linguistic diversity. 

```{r}
cv.diversity <- lm(data = final.data, cv_ratio_num ~ diversity.new)
summary(cv.diversity)
```

### Tone

There is no significant correlation between linguistic diversity and tone. 

```{r}
tone.diversity <- lm(data = final.data, tone_num ~ diversity.new)
summary(tone.diversity)

```

# Next check for correlation between environmental features and GDP/linguistic diversity

## GDP

### Altitude and GDP

There is a correlation between altitude and GDP

```{r}
elev.GDP <- lm(data = final.data, mean_hum ~ `2018`)
summary(elev.GDP)
```

### Latitude and GDP

There is a significant correlation between distance from the equator (absolute value of Latitude) and GDP.

```{r}
final.data$latitude_abs <- final.data$Latitude

final.data <- final.data %>%
  mutate(latitude_abs = abs(latitude_abs))


latitude.GDP <- lm(data = final.data, latitude_abs ~ `2018`)
summary(latitude.GDP)
```

### Humidity and GDP

There is a significant correlation between humidity and GDP. 

```{r}
hum.GDP <- lm(data = final.data, mean_hum ~ `2018`)
summary(hum.GDP)
```

## Linguistic Diversity

There is a significant correlation between linguistic diversity and each altitude, elevation, and humidity. 


### Altitude

```{r}
elev.diversity <- lm(data = final.data, mean_hum ~ diversity.new)
summary(elev.diversity)
```

### Latitude 

```{r}
latitude.diversity <- lm(data = final.data, latitude_abs ~ diversity.new)
summary(latitude.diversity)
```

### Humidity
```{r}
hum.diversity <- lm(data = final.data, mean_hum ~ diversity.new)
summary(hum.diversity)
```
